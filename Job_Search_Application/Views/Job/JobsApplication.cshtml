@model Job_Search_Application.Models.Jobs_Model;

@{
    ViewData["Title"] = "Published Job";
}

<div class="row d-flex justify-content-center">
    <div class="col-md-10 shadow" style="background-color: aliceblue; border-radius: 20px;">
        <br />
        <div class="card-header">
            <h5>@Html.DisplayFor(modelItem => modelItem.Title)</h5>
            <h6 class="text-capitalize fw-bold">@Html.DisplayFor(modelItem => modelItem.Employer.Company_Name)</h6>
        </div>
        <div class="card-body">
            <p class="text-capitalize">@Html.DisplayFor(modelItem => modelItem.Job_Location)</p>
            <p class="text-capitalize d-inline">@Html.DisplayFor(modelItem => modelItem.Job_Schedule)</p>
            <p class="text-capitalize">@Html.DisplayFor(modelItem => modelItem.Job_Type)</p>
            <p class="text-capitalize"> @Html.DisplayFor(modelItem => modelItem.Classification)</p>
            <p class="text-capitalize">@Html.DisplayFor(modelItem => modelItem.Salary)</p>
        </div>

        <div class="card-footer">
            <p>@Html.DisplayFor(modelItem => modelItem.Job_Details)</p>
            <button id="saveButton" class="btn btn-primary" onclick="saveJob('@Model.Jobs_Id')" style="display: none">Save Job</button>
            <button id="unsaveButton" class="btn btn-primary" onclick="unsaveJob('@Model.Jobs_Id')" style="display: none">Unsave Job</button>
        </div>
        <br />
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
    $(document).ready(function () {
        var jobId = '@Model.Jobs_Id';

        // Check if the job is already saved
        $.ajax({
            url: '/Employee/CheckSavedJob',
            type: 'POST',
            data: { jobId: jobId },
            success: function (response) {
                if (response === true) {
                    // Job is saved, hide the save button and show the unsave button
                    $('#saveButton').hide();
                    $('#unsaveButton').show();
                } else {
                    // Job is not saved, show the save button and hide the unsave button
                    $('#saveButton').show();
                    $('#unsaveButton').hide();
                }
            },
            error: function () {
                // Handle the error response, e.g., show an error message
                alert('An error occurred while checking if the job is saved.');
            }
        });
    });

    function saveJob(jobId) {
        // Send an AJAX request to save the job
        $.ajax({
            url: '/Employee/SaveJob',
            type: 'POST',
            data: { jobId: jobId },
            success: function () {
                // Handle the success response, e.g., show a success message
           
                // Hide the save button and show the unsave button
                $('#saveButton').hide();
                $('#unsaveButton').show();
            },
            error: function () {
                // Handle the error response, e.g., show an error message
                alert('An error occurred while saving the job.');
            }
        });
    }

    function unsaveJob(jobId) {
        // Send an AJAX request to unsave the job
        $.ajax({
            url: '/Employee/UnsaveJob',
            type: 'POST',
            data: { jobId: jobId },
            success: function () {
                // Handle the success response, e.g., show a success message
               
                // Hide the unsave button and show the save button
                $('#unsaveButton').hide();
                $('#saveButton').show();
            },
            error: function () {
                // Handle the error response, e.g., show an error message
                alert('An error occurred while unsaving the job.');
            }
        });
    }
</script>
